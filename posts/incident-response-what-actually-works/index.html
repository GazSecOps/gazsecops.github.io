<!doctype html><html lang=en><head><title>Incident Response: What Actually Works at 3am :: Gareth's Engineering Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=" On-call: I&rsquo;m getting paged. Something about unusual outbound traffic.
Management: Is it a breach?
On-call: I don&rsquo;t know yet. I&rsquo;ve been awake for forty seconds.
Management: We need to tell the board by 8am.
On-call: I need to tell you what&rsquo;s happening first. Give me an hour.
Management: You have thirty minutes.
Incident response plans look great in documents. Neat flowcharts. Escalation matrices. Communication templates. Everyone has a role. Everyone knows what to do.
Then something actually happens and none of it works the way the document said it would.
The best incident response plan is the one your team has actually practised. The second best is any plan at all. Most teams have neither. This post is about what incident response looks like in practice. Not the framework version. The version where you&rsquo;re half awake, the logs are incomplete, and someone is asking you to confirm it&rsquo;s not a breach before you&rsquo;ve even found the right terminal.
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://gazsecops.github.io/posts/incident-response-what-actually-works/><link rel=stylesheet href=https://gazsecops.github.io/css/extended.min.c658c723e006469d82f697e19c5338967fad12c57650bdd915bacf9cfbe2cc38.css><link rel=stylesheet href=https://gazsecops.github.io/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://gazsecops.github.io/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://gazsecops.github.io/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://gazsecops.github.io/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://gazsecops.github.io/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://gazsecops.github.io/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://gazsecops.github.io/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css><link rel=stylesheet href=https://gazsecops.github.io/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css><link rel=stylesheet href=https://gazsecops.github.io/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://gazsecops.github.io/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css><link rel=stylesheet href=https://gazsecops.github.io/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css><link rel=stylesheet href=https://gazsecops.github.io/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://gazsecops.github.io/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel="shortcut icon" href=https://gazsecops.github.io/favicon.png><link rel=apple-touch-icon href=https://gazsecops.github.io/apple-touch-icon.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Incident Response: What Actually Works at 3am"><meta property="og:description" content=" On-call: I&rsquo;m getting paged. Something about unusual outbound traffic.
Management: Is it a breach?
On-call: I don&rsquo;t know yet. I&rsquo;ve been awake for forty seconds.
Management: We need to tell the board by 8am.
On-call: I need to tell you what&rsquo;s happening first. Give me an hour.
Management: You have thirty minutes.
Incident response plans look great in documents. Neat flowcharts. Escalation matrices. Communication templates. Everyone has a role. Everyone knows what to do.
Then something actually happens and none of it works the way the document said it would.
The best incident response plan is the one your team has actually practised. The second best is any plan at all. Most teams have neither. This post is about what incident response looks like in practice. Not the framework version. The version where you&rsquo;re half awake, the logs are incomplete, and someone is asking you to confirm it&rsquo;s not a breach before you&rsquo;ve even found the right terminal.
"><meta property="og:url" content="https://gazsecops.github.io/posts/incident-response-what-actually-works/"><meta property="og:site_name" content="Gareth's Engineering Blog"><meta property="og:image" content="https://gazsecops.github.io/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2025-07-02 10:00:00 +0000 UTC"></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>gareth@blog:~$</div></a></div><div class=header__search><input type=text id=header-search placeholder="Quick search..." style="padding:5px 10px;background:#222;color:#eee;border:1px solid #444;border-radius:3px;font-size:14px;width:200px"></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/topics/>Topics</a></li><li><a href=/posts/>All</a></li><li><a href=/series/>Series</a></li><li><a href=/tags/>Tags</a></li><li><a href=/archive/>Archive</a></li><li><a href=/search/>Search</a></li><li><a href=/about/>About</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/topics/>Topics</a></li><li><a href=/posts/>All</a></li><li><a href=/series/>Series</a></li><li><a href=/tags/>Tags</a></li><li><a href=/archive/>Archive</a></li><li><a href=/search/>Search</a></li><li><a href=/about/>About</a></li></ul></nav></header><script>(function(){const e=document.getElementById("header-search");if(!e)return;e.addEventListener("keydown",function(e){if(e.key==="Enter"){const e=this.value.trim();e&&(window.location.href="/search?q="+encodeURIComponent(e))}}),document.addEventListener("keydown",function(t){t.key==="/"&&!["INPUT","TEXTAREA"].includes(t.target.tagName)&&(t.preventDefault(),e.focus()),t.key==="Escape"&&t.target===e&&e.blur()})})()</script><style>.header__inner{display:flex;align-items:center;gap:20px}.header__search{flex:none}#header-search::placeholder{color:#666;font-style:italic}#header-search:focus{outline:none;border-color:#888}@media(max-width:684px){.header__search{display:none}}</style><div class=content><article class=post><h1 class=post-title><a href=https://gazsecops.github.io/posts/incident-response-what-actually-works/>Incident Response: What Actually Works at 3am</a></h1><div class=post-meta><time class=post-date>2025-07-02</time><span class=post-author>Gareth</span><span class=post-reading-time>11 min read (2146 words)</span></div><span class=post-tags>#<a href=https://gazsecops.github.io/tags/security/>security</a>&nbsp;
#<a href=https://gazsecops.github.io/tags/incident-response/>incident-response</a>&nbsp;
#<a href=https://gazsecops.github.io/tags/operations/>operations</a>&nbsp;
#<a href=https://gazsecops.github.io/tags/linux/>linux</a>&nbsp;
#<a href=https://gazsecops.github.io/tags/cloud/>cloud</a>&nbsp;</span><div class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#why-most-ir-plans-fail>Why Most IR Plans Fail</a></li><li><a href=#the-first-thirty-minutes>The First Thirty Minutes</a><ul><li><a href=#1-confirm-its-real>1. Confirm it&rsquo;s real</a></li><li><a href=#2-contain-first-investigate-later>2. Contain first, investigate later</a></li><li><a href=#3-preserve-evidence>3. Preserve evidence</a></li><li><a href=#4-establish-communication>4. Establish communication</a></li></ul></li><li><a href=#triage-what-am-i-looking-at>Triage: What Am I Looking At?</a><ul><li><a href=#ask-these-questions-in-order>Ask these questions in order</a></li><li><a href=#where-to-look-linux>Where to look (Linux)</a></li><li><a href=#where-to-look-cloud>Where to look (cloud)</a></li></ul></li><li><a href=#escalation-when-to-wake-people-up>Escalation: When to Wake People Up</a></li><li><a href=#communication-during-an-incident>Communication During an Incident</a></li><li><a href=#containment-patterns>Containment Patterns</a><ul><li><a href=#compromised-account>Compromised account</a></li><li><a href=#compromised-host>Compromised host</a></li><li><a href=#leaked-credentials>Leaked credentials</a></li><li><a href=#cloud-resource-compromise>Cloud resource compromise</a></li></ul></li><li><a href=#post-incident-the-part-everyone-skips>Post-Incident: The Part Everyone Skips</a><ul><li><a href=#what-a-useful-post-mortem-covers>What a useful post-mortem covers</a></li><li><a href=#what-a-useless-post-mortem-looks-like>What a useless post-mortem looks like</a></li><li><a href=#blameless-doesnt-mean-accountability-free>Blameless doesn&rsquo;t mean accountability-free</a></li></ul></li><li><a href=#building-the-muscle>Building the Muscle</a></li><li><a href=#the-boring-truth>The Boring Truth</a></li></ul></nav></div><div class=post-content><div><div class=dialogue><p><span class="speaker speaker-oncall">On-call:</span> I&rsquo;m getting paged. Something about unusual outbound traffic.</p><p><span class="speaker speaker-management">Management:</span> Is it a breach?</p><p><span class="speaker speaker-oncall">On-call:</span> I don&rsquo;t know yet. I&rsquo;ve been awake for forty seconds.</p><p><span class="speaker speaker-management">Management:</span> We need to tell the board by 8am.</p><p><span class="speaker speaker-oncall">On-call:</span> I need to tell you what&rsquo;s happening first. Give me an hour.</p><p><span class="speaker speaker-management">Management:</span> You have thirty minutes.</p></div><p>Incident response plans look great in documents. Neat flowcharts. Escalation matrices. Communication templates. Everyone has a role. Everyone knows what to do.</p><p>Then something actually happens and none of it works the way the document said it would.</p><aside class=pullquote>The best incident response plan is the one your team has actually practised. The second best is any plan at all. Most teams have neither.</aside><p>This post is about what incident response looks like in practice. Not the framework version. The version where you&rsquo;re half awake, the logs are incomplete, and someone is asking you to confirm it&rsquo;s not a breach before you&rsquo;ve even found the right terminal.</p><h2 id=why-most-ir-plans-fail>Why Most IR Plans Fail<a href=#why-most-ir-plans-fail class=hanchor arialabel=Anchor>#</a></h2><p>They fail for the same reason most plans fail: they were written for a world that doesn&rsquo;t exist.</p><p><strong>The plan assumes:</strong></p><ul><li>You&rsquo;ll know what happened quickly</li><li>The right people will be available</li><li>Logs will contain what you need</li><li>Communication channels will work</li><li>Everyone will follow the process</li></ul><p><strong>Reality:</strong></p><ul><li>You don&rsquo;t know what happened for hours (sometimes days)</li><li>The one person who understands the system is on holiday</li><li>The logs you need were rotated yesterday or never existed</li><li>The Slack channel fills with speculation from people who aren&rsquo;t helping</li><li>Half the team hasn&rsquo;t read the plan</li></ul><p>The plan isn&rsquo;t useless. But it&rsquo;s a starting point, not a script.</p><h2 id=the-first-thirty-minutes>The First Thirty Minutes<a href=#the-first-thirty-minutes class=hanchor arialabel=Anchor>#</a></h2><p>The first thirty minutes set the tone for everything that follows. Get them wrong and you&rsquo;re chasing your tail for days.</p><h3 id=1-confirm-its-real>1. Confirm it&rsquo;s real<a href=#1-confirm-its-real class=hanchor arialabel=Anchor>#</a></h3><p>Not everything that looks like an incident is one. Before you wake people up and start an incident bridge, answer one question: is this actually happening?</p><p>Check:</p><ul><li>Is the alert legitimate or a false positive?</li><li>Can you reproduce or observe the behaviour?</li><li>Is this a known issue (deployment, maintenance window, config change)?</li></ul><p>Quick triage, not investigation. You&rsquo;re not trying to understand the full picture yet. You&rsquo;re trying to decide whether to escalate.</p><h3 id=2-contain-first-investigate-later>2. Contain first, investigate later<a href=#2-contain-first-investigate-later class=hanchor arialabel=Anchor>#</a></h3><p>If it looks real, your first job is to stop it getting worse. Not to understand it. Not to find root cause. To contain.</p><p><strong>Containment actions (pick what fits):</strong></p><ul><li>Isolate the affected system (network ACL, security group, pull the cable)</li><li>Disable the compromised account</li><li>Block the suspicious IP or domain</li><li>Revoke the leaked credential</li><li>Kill the process</li></ul><p>You will feel pressure to investigate first. Resist it. Every minute you spend understanding the problem is a minute the attacker (or the failure) is still active.</p><div class=dialogue><p><span class="speaker speaker-engineer">Engineer:</span> We should figure out what they accessed before we cut them off.</p><p><span class="speaker speaker-sysadmin">Sysadmin:</span> No. We cut them off now. We figure out what they accessed from the logs after.</p><p><span class="speaker speaker-engineer">Engineer:</span> What if we lose forensic evidence?</p><p><span class="speaker speaker-sysadmin">Sysadmin:</span> What if they&rsquo;re still exfiltrating data while we discuss it?</p></div><p>Contain. Then investigate. Not the other way around.</p><h3 id=3-preserve-evidence>3. Preserve evidence<a href=#3-preserve-evidence class=hanchor arialabel=Anchor>#</a></h3><p>Containment doesn&rsquo;t mean destroy evidence. When you isolate a system:</p><ul><li>Snapshot it first if you can (VM snapshot, disk image)</li><li>Don&rsquo;t reboot it (volatile memory is evidence)</li><li>Don&rsquo;t &ldquo;clean up&rdquo; anything yet</li><li>Note the time of every action you take</li></ul><p>On Linux, before you touch anything:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Capture volatile state</span>
</span></span><span style=display:flex><span>date -u &gt; /tmp/ir_timestamp
</span></span><span style=display:flex><span>ps auxf &gt; /tmp/ir_processes
</span></span><span style=display:flex><span>ss -tunap &gt; /tmp/ir_network
</span></span><span style=display:flex><span>who &gt; /tmp/ir_users
</span></span><span style=display:flex><span>cat /proc/*/cmdline 2&gt;/dev/null | tr <span style=color:#e6db74>&#39;\0&#39;</span> <span style=color:#e6db74>&#39; &#39;</span> | sort -u &gt; /tmp/ir_cmdlines
</span></span><span style=display:flex><span>last -20 &gt; /tmp/ir_logins
</span></span></code></pre></div><p>In cloud, snapshot the instance and its volumes. Don&rsquo;t terminate it.</p><h3 id=4-establish-communication>4. Establish communication<a href=#4-establish-communication class=hanchor arialabel=Anchor>#</a></h3><p>You need one channel. Not five.</p><ul><li>One incident channel (Slack, Teams, whatever)</li><li>One incident lead (one person making decisions, not a committee)</li><li>One scribe (someone writing down what&rsquo;s happening, when, and what was decided)</li></ul><p>Keep spectators out. The incident channel is for people working the incident. Everyone else gets updates on a schedule.</p><h2 id=triage-what-am-i-looking-at>Triage: What Am I Looking At?<a href=#triage-what-am-i-looking-at class=hanchor arialabel=Anchor>#</a></h2><p>Once you&rsquo;ve contained and preserved, you need to understand what happened. This is where most teams get stuck because they don&rsquo;t have a system for it.</p><h3 id=ask-these-questions-in-order>Ask these questions in order<a href=#ask-these-questions-in-order class=hanchor arialabel=Anchor>#</a></h3><p><strong>1. What&rsquo;s the scope?</strong></p><ul><li>How many systems are affected?</li><li>Is it one host, one service, one account, or the whole environment?</li><li>Is it spreading?</li></ul><p><strong>2. What&rsquo;s the timeline?</strong></p><ul><li>When did it start? (check logs, not guesses)</li><li>When was it detected?</li><li>What&rsquo;s the gap? (dwell time matters)</li></ul><p><strong>3. What&rsquo;s the impact?</strong></p><ul><li>Is data exposed? What kind?</li><li>Are services down? Which ones?</li><li>Are customers affected?</li><li>Are credentials compromised?</li></ul><p><strong>4. What&rsquo;s the vector?</strong></p><ul><li>How did they get in? (phishing, exploit, credential, misconfiguration)</li><li>What did they do after getting in?</li><li>Where did they go?</li></ul><p>You won&rsquo;t answer all of these immediately. That&rsquo;s fine. Partial answers are better than no answers. Update as you learn more.</p><h3 id=where-to-look-linux>Where to look (Linux)<a href=#where-to-look-linux class=hanchor arialabel=Anchor>#</a></h3><p>When you&rsquo;re on a potentially compromised Linux box:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Auth events (distro differences)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - Debian/Ubuntu: /var/log/auth.log</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - RHEL/CentOS: /var/log/secure</span>
</span></span><span style=display:flex><span>journalctl -u ssh -u sshd --since <span style=color:#e6db74>&#34;24 hours ago&#34;</span> --no-pager
</span></span><span style=display:flex><span>sudo tail -n <span style=color:#ae81ff>200</span> /var/log/auth.log 2&gt;/dev/null
</span></span><span style=display:flex><span>sudo tail -n <span style=color:#ae81ff>200</span> /var/log/secure 2&gt;/dev/null
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># What&#39;s running</span>
</span></span><span style=display:flex><span>ps auxf
</span></span><span style=display:flex><span>ls -la /proc/*/exe 2&gt;/dev/null | grep deleted
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># What&#39;s talking to the network</span>
</span></span><span style=display:flex><span>ss -tunap
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># What listeners exist (often quicker than scrolling ss output)</span>
</span></span><span style=display:flex><span>sudo ss -ltnup
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Quick packet capture (if you can do it without making things worse)</span>
</span></span><span style=display:flex><span>sudo timeout <span style=color:#ae81ff>30</span> tcpdump -ni any -w /tmp/ir_capture.pcap 2&gt;/dev/null
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># What changed recently</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Don&#39;t do `find /` on a big box unless you enjoy self-inflicted outages.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Start with likely places and stay on one filesystem.</span>
</span></span><span style=display:flex><span>sudo find /etc /var /home -xdev -mmin -120 -type f 2&gt;/dev/null
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Cron (persistence check)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> u in <span style=color:#66d9ef>$(</span>cut -f1 -d: /etc/passwd<span style=color:#66d9ef>)</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;--- </span>$u<span style=color:#e6db74> ---&#34;</span>
</span></span><span style=display:flex><span>    crontab -u <span style=color:#e6db74>&#34;</span>$u<span style=color:#e6db74>&#34;</span> -l 2&gt;/dev/null
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>ls -la /etc/cron.*
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Unusual SUID binaries</span>
</span></span><span style=display:flex><span>sudo find / -xdev -perm -4000 -type f 2&gt;/dev/null
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Systemd timers and services (persistence)</span>
</span></span><span style=display:flex><span>systemctl list-timers --all --no-pager
</span></span><span style=display:flex><span>systemctl list-unit-files --state<span style=color:#f92672>=</span>enabled --no-pager
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Users and keys (persistence)</span>
</span></span><span style=display:flex><span>getent passwd
</span></span><span style=display:flex><span>sudo find /home -maxdepth <span style=color:#ae81ff>3</span> -name authorized_keys -type f -print -exec ls -la <span style=color:#f92672>{}</span> <span style=color:#ae81ff>\;</span> 2&gt;/dev/null
</span></span></code></pre></div><p>Two things that save time:</p><ol><li>Get a list of suspicious PIDs and work backwards. What&rsquo;s the parent process? What user? What binary? What network sockets?</li><li>Don&rsquo;t run ten tools. Run three tools and actually read the output.</li></ol><h3 id=where-to-look-cloud>Where to look (cloud)<a href=#where-to-look-cloud class=hanchor arialabel=Anchor>#</a></h3><p>When the incident is in AWS, Azure, or GCP:</p><ul><li><strong>CloudTrail / Activity Log / Audit Log:</strong> who did what, when</li><li><strong>VPC Flow Logs / NSG Flow Logs:</strong> network connections</li><li><strong>GuardDuty / Defender / Security Command Centre:</strong> automated findings</li><li><strong>IAM:</strong> what permissions does the compromised identity have? What could they reach?</li><li><strong>S3/Storage access logs:</strong> did they access data stores?</li></ul><p>The first question in cloud is always: &ldquo;what permissions did the compromised identity have?&rdquo; That tells you the blast radius.</p><h4 id=aws-quick-triage>AWS quick triage<a href=#aws-quick-triage class=hanchor arialabel=Anchor>#</a></h4><p>Find recent API activity (CloudTrail):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>aws cloudtrail lookup-events <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --lookup-attributes AttributeKey<span style=color:#f92672>=</span>Username,AttributeValue<span style=color:#f92672>=</span>COMPROMISED_IDENTITY <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --max-results <span style=color:#ae81ff>50</span>
</span></span></code></pre></div><p>Check access keys and when they were last used:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>aws iam list-access-keys --user-name COMPROMISED_USER
</span></span><span style=display:flex><span>aws iam get-access-key-last-used --access-key-id AKIA...
</span></span></code></pre></div><p>Containment patterns that don&rsquo;t destroy evidence:</p><ul><li>Detach policies / reduce permissions first (stop the bleeding)</li><li>Disable access keys (keep the user for investigation)</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>aws iam update-access-key --user-name COMPROMISED_USER --access-key-id AKIA... --status Inactive
</span></span></code></pre></div><h4 id=azure-quick-triage>Azure quick triage<a href=#azure-quick-triage class=hanchor arialabel=Anchor>#</a></h4><p>Control-plane changes are in Activity Log:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>az monitor activity-log list <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --status Succeeded <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --max-events <span style=color:#ae81ff>50</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --offset 6h <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -o table
</span></span></code></pre></div><p>For a managed identity, the fastest &ldquo;blast radius&rdquo; check is role assignments:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>az role assignment list --assignee-object-id OBJECT_ID --all -o table
</span></span></code></pre></div><h4 id=gcp-quick-triage>GCP quick triage<a href=#gcp-quick-triage class=hanchor arialabel=Anchor>#</a></h4><p>Cloud Audit Logs are your starting point:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>gcloud logging read <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;protoPayload.authenticationInfo.principalEmail=&#34;user@example.com&#34;&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --limit<span style=color:#f92672>=</span><span style=color:#ae81ff>50</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --freshness<span style=color:#f92672>=</span>6h
</span></span></code></pre></div><h2 id=escalation-when-to-wake-people-up>Escalation: When to Wake People Up<a href=#escalation-when-to-wake-people-up class=hanchor arialabel=Anchor>#</a></h2><p>Not every incident needs the CEO on a call. Not every alert needs the whole team.</p><p><strong>Severity guide (adapt to your context):</strong></p><table><thead><tr><th>Severity</th><th>What it means</th><th>Who gets woken up</th></tr></thead><tbody><tr><td>Low</td><td>Suspicious activity, no confirmed impact</td><td>On-call investigates, updates in morning</td></tr><tr><td>Medium</td><td>Confirmed compromise, limited scope</td><td>On-call + team lead, incident channel opened</td></tr><tr><td>High</td><td>Active breach, data exposure, spreading</td><td>Full IR team, management notified</td></tr><tr><td>Critical</td><td>Business-threatening, regulatory, public</td><td>Everyone. Legal. Comms. Executive team.</td></tr></tbody></table><p>The hardest call is escalating from medium to high. You don&rsquo;t want to cry wolf. You also don&rsquo;t want to be the person who sat on a breach for six hours because you weren&rsquo;t sure.</p><p><strong>Rule of thumb:</strong> if you&rsquo;re debating whether to escalate, escalate.</p><h2 id=communication-during-an-incident>Communication During an Incident<a href=#communication-during-an-incident class=hanchor arialabel=Anchor>#</a></h2><p>Communication is where incidents go wrong almost as often as the technical response.</p><p><strong>Internal updates:</strong></p><ul><li>Regular cadence (every 30 minutes during active incidents)</li><li>Facts only, no speculation</li><li>What we know, what we&rsquo;re doing, what we don&rsquo;t know yet</li><li>Next update time</li></ul><p><strong>Management updates:</strong></p><ul><li>Translate technical details into business impact</li><li>&ldquo;The attacker accessed a server that processes customer orders&rdquo; not &ldquo;they got a reverse shell on prod-app-03&rdquo;</li><li>Be honest about uncertainty. &ldquo;We don&rsquo;t know yet&rdquo; is better than a wrong answer</li></ul><p><strong>External communication (if needed):</strong></p><ul><li>Legal decides when and what to disclose</li><li>Comms drafts the message</li><li>Don&rsquo;t let engineers write customer notifications at 4am</li></ul><p><strong>What not to do:</strong></p><ul><li>Speculate in the incident channel</li><li>Blame people during the incident</li><li>Share details outside the IR team before authorised</li><li>Post updates on social media</li></ul><h2 id=containment-patterns>Containment Patterns<a href=#containment-patterns class=hanchor arialabel=Anchor>#</a></h2><p>Different incidents need different containment.</p><h3 id=compromised-account>Compromised account<a href=#compromised-account class=hanchor arialabel=Anchor>#</a></h3><ol><li>Disable the account</li><li>Revoke all sessions and tokens</li><li>Rotate credentials</li><li>Check what the account accessed (audit logs)</li><li>Check for persistence (new SSH keys, new API keys, forwarding rules)</li></ol><h3 id=compromised-host>Compromised host<a href=#compromised-host class=hanchor arialabel=Anchor>#</a></h3><ol><li>Isolate from network (don&rsquo;t power off)</li><li>Snapshot disk and memory if possible</li><li>Check for lateral movement (did they pivot?)</li><li>Check outbound connections (where were they talking to?)</li><li>Check persistence (cron, systemd, SSH keys, modified binaries)</li></ol><h3 id=leaked-credentials>Leaked credentials<a href=#leaked-credentials class=hanchor arialabel=Anchor>#</a></h3><ol><li>Rotate immediately</li><li>Check if they were used (audit logs)</li><li>Identify scope (what does this credential access?)</li><li>Check for secondary compromise (did they use the creds to get further access?)</li><li>Find the source (where were they leaked? Git repo? Log file? Slack message?)</li></ol><h3 id=cloud-resource-compromise>Cloud resource compromise<a href=#cloud-resource-compromise class=hanchor arialabel=Anchor>#</a></h3><ol><li>Restrict IAM permissions (don&rsquo;t delete the role - you need it for investigation)</li><li>Revoke temporary credentials (STS sessions in AWS)</li><li>Check CloudTrail/Activity Log for actions taken</li><li>Snapshot affected resources</li><li>Check for new resources created (instances, users, keys, buckets)</li></ol><h2 id=post-incident-the-part-everyone-skips>Post-Incident: The Part Everyone Skips<a href=#post-incident-the-part-everyone-skips class=hanchor arialabel=Anchor>#</a></h2><p>The incident is over. Systems are restored. Everyone&rsquo;s tired. Nobody wants to sit in a meeting about it.</p><p>Do the post-mortem anyway.</p><h3 id=what-a-useful-post-mortem-covers>What a useful post-mortem covers<a href=#what-a-useful-post-mortem-covers class=hanchor arialabel=Anchor>#</a></h3><ul><li><strong>Timeline:</strong> What happened, when, in order. Not from memory. From logs and the scribe notes.</li><li><strong>Detection:</strong> How was it detected? How long was the gap between start and detection?</li><li><strong>Response:</strong> What worked? What didn&rsquo;t? Where did we waste time?</li><li><strong>Root cause:</strong> Why did it happen? Not just &ldquo;attacker exploited vulnerability&rdquo; but &ldquo;why was that vulnerability there, why wasn&rsquo;t it patched, why didn&rsquo;t we detect it sooner?&rdquo;</li><li><strong>Actions:</strong> Specific, owned, time-bound actions to prevent recurrence</li></ul><h3 id=what-a-useless-post-mortem-looks-like>What a useless post-mortem looks like<a href=#what-a-useless-post-mortem-looks-like class=hanchor arialabel=Anchor>#</a></h3><ul><li>Blame session disguised as a review</li><li>&ldquo;Lessons learned&rdquo; that nobody follows up on</li><li>Actions assigned to &ldquo;the team&rdquo; with no deadline</li><li>The same post-mortem as last time because nothing changed</li></ul><h3 id=blameless-doesnt-mean-accountability-free>Blameless doesn&rsquo;t mean accountability-free<a href=#blameless-doesnt-mean-accountability-free class=hanchor arialabel=Anchor>#</a></h3><p>Blameless post-mortems are about not punishing individuals for systemic failures. They&rsquo;re not about pretending nobody made mistakes.</p><p>&ldquo;The deploy script didn&rsquo;t check for the config error&rdquo; is blameless.</p><p>&ldquo;Nobody&rsquo;s responsible for the deploy script being broken&rdquo; is not blameless. It&rsquo;s useless.</p><p>Someone needs to own the fix. With a deadline. And someone needs to check it happened.</p><h2 id=building-the-muscle>Building the Muscle<a href=#building-the-muscle class=hanchor arialabel=Anchor>#</a></h2><p>Incident response is a skill. Skills atrophy without practice.</p><p><strong>Tabletop exercises:</strong>
Run through scenarios without touching systems. &ldquo;It&rsquo;s Tuesday morning. You get an alert that&mldr;&rdquo; Walk through the response. Find the gaps.</p><p>Do this quarterly. It takes two hours. It&rsquo;s worth more than a hundred pages of documentation.</p><p><strong>Game days:</strong>
Actually simulate incidents in a test environment. Kill a service. Inject suspicious traffic. See how the team responds.</p><p>Harder to organise. Much more valuable.</p><p><strong>On-call rotations:</strong>
If your security team doesn&rsquo;t do on-call, your incident response will be slow. The people who respond to incidents need to be comfortable being woken up and making decisions under pressure.</p><h2 id=the-boring-truth>The Boring Truth<a href=#the-boring-truth class=hanchor arialabel=Anchor>#</a></h2><p>Incident response isn&rsquo;t about having the best tools or the cleverest analysts. It&rsquo;s about:</p><ul><li>Containing fast (minutes, not hours)</li><li>Communicating clearly (facts, not speculation)</li><li>Investigating methodically (timeline, scope, impact, vector)</li><li>Following up properly (actions that actually happen)</li></ul><p>Most of it is process. Most of that process is boring. The boring process is what stops a contained incident from becoming front-page news.</p><p>Have a plan. Practise the plan. Accept that the plan won&rsquo;t survive contact with reality. Adapt.</p><p>And keep your phone charged. The 3am call is coming.</p><hr><p><em>For AI-specific incident response (where &ldquo;I don&rsquo;t know why it&rsquo;s wrong&rdquo; is the honest answer), see the <a href=/posts/ai-systems-responsibility-part-3/>AI series Part 3</a>. For monitoring that gives you something to investigate, the <a href=/posts/prometheus-security-monitoring/>Prometheus post</a> and the <a href=/posts/dns-security-what-actually-breaks/>DNS security post</a> cover the signals worth watching.</em></p></div></div><div class=related-posts style="margin-top:3rem;padding-top:2rem;border-top:1px solid #333"><h3>Related Posts</h3><ul style=list-style:none;padding:0><li style=margin-bottom:1rem><a href=https://gazsecops.github.io/posts/dns-security-what-actually-breaks/>DNS Security: What Actually Breaks</a>
<span style=color:#999;font-size:.9rem>- 12 Jun 2025</span><div style=font-size:.85rem;color:#666;margin-top:.25rem><span style=margin-right:.5rem>#security</span>
<span style=margin-right:.5rem>#dns</span>
<span style=margin-right:.5rem>#linux</span>
<span style=margin-right:.5rem>#cloud</span>
<span style=margin-right:.5rem>#monitoring</span>
<span style=margin-right:.5rem>#operations</span>
<span style=margin-right:.5rem>#incident-response</span></div></li><li style=margin-bottom:1rem><a href=https://gazsecops.github.io/posts/stepca-running-internal-pki/>Smallstep step-ca: Running Internal PKI Without Losing Your Mind</a>
<span style=color:#999;font-size:.9rem>- 28 Oct 2025</span><div style=font-size:.85rem;color:#666;margin-top:.25rem><span style=margin-right:.5rem>#security</span>
<span style=margin-right:.5rem>#pki</span>
<span style=margin-right:.5rem>#tls</span>
<span style=margin-right:.5rem>#certificates</span>
<span style=margin-right:.5rem>#linux</span>
<span style=margin-right:.5rem>#cloud</span>
<span style=margin-right:.5rem>#operations</span></div></li><li style=margin-bottom:1rem><a href=https://gazsecops.github.io/posts/zero-trust-what-it-actually-means/>Zero Trust: What It Actually Means When You Have to Implement It</a>
<span style=color:#999;font-size:.9rem>- 5 Aug 2025</span><div style=font-size:.85rem;color:#666;margin-top:.25rem><span style=margin-right:.5rem>#security</span>
<span style=margin-right:.5rem>#zero-trust</span>
<span style=margin-right:.5rem>#networking</span>
<span style=margin-right:.5rem>#identity</span>
<span style=margin-right:.5rem>#cloud</span>
<span style=margin-right:.5rem>#operations</span></div></li><li style=margin-bottom:1rem><a href=https://gazsecops.github.io/posts/password-managers-2025/>Password Managers in 2025: What Actually Works</a>
<span style=color:#999;font-size:.9rem>- 15 Apr 2025</span><div style=font-size:.85rem;color:#666;margin-top:.25rem><span style=margin-right:.5rem>#security</span>
<span style=margin-right:.5rem>#passwords</span>
<span style=margin-right:.5rem>#vault</span>
<span style=margin-right:.5rem>#linux</span>
<span style=margin-right:.5rem>#operations</span></div></li><li style=margin-bottom:1rem><a href=https://gazsecops.github.io/posts/ssh-hardening-what-actually-matters/>SSH Hardening: What Actually Matters</a>
<span style=color:#999;font-size:.9rem>- 18 Mar 2025</span><div style=font-size:.85rem;color:#666;margin-top:.25rem><span style=margin-right:.5rem>#security</span>
<span style=margin-right:.5rem>#ssh</span>
<span style=margin-right:.5rem>#linux</span>
<span style=margin-right:.5rem>#operations</span>
<span style=margin-right:.5rem>#hardening</span></div></li></ul></div><div class=pagination><div class=pagination__title><span class=pagination__title-h></span><hr></div><div class=pagination__buttons><a href=https://gazsecops.github.io/posts/zero-trust-what-it-actually-means/ class="button inline prev">&lt; [<span class=button__text>Zero Trust: What It Actually Means When You Have to Implement It</span>]
</a>::
<a href=https://gazsecops.github.io/posts/dns-security-what-actually-breaks/ class="button inline next">[<span class=button__text>DNS Security: What Actually Breaks</span>] ></a></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2026</span></div><div class=build-info><span class=build-commit>e733073</span><span class=build-date>2026-02-12 12:33 UTC</span></div></div></footer></div></body></html>